{"version":3,"file":"lit-element.js","sourceRoot":"","sources":["../src/lit-element.ts"],"names":[],"mappings":"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","sourcesContent":["import { html, render } from '../node_modules/lit-html/lib/lit-extended.js';\nimport { TemplateResult } from '../node_modules/lit-html/lit-html.js';\n\nexport { html } from '../node_modules/lit-html/lib/lit-extended.js';\nexport interface PropertyDeclaration {\n  type: (a: any) => any;\n  value?: any;\n  attrName?: string;\n}\n\ninterface PropertyValues {\n  [key: string]: any;\n}\n\ninterface ElementCache {\n  [key: string]: any; // HTMLElement\n}\n\nexport class LitElement extends HTMLElement {\n  private _needsRender: boolean = false;\n  private _lookupCache: ElementCache = [];\n  private _values: PropertyValues = [];\n\n  static get properties(): PropertyDeclaration[] {\n    return [];\n  }\n\n  static get observedAttributes(): string[] {\n    const attrs = [];\n    for (const prop in this.properties) {\n      if (this.properties[prop].attrName) {\n        attrs.push(prop);\n      }\n    }\n    return attrs;\n  }\n\n  constructor() {\n    super();\n    this.attachShadow({ mode: 'open' });\n  }\n\n  static withProperties() {\n    for (const prop in this.properties) {\n      const { type: typeFn, value, attrName } = this.properties[prop];\n\n      Object.defineProperty(this.prototype, prop, {\n        get(this: LitElement) { return this._values[prop] || value; },\n        set(this: LitElement, v) {\n          const value = typeFn(v);\n          this._values[prop] = value;\n          if (attrName) {\n            if (typeFn.name === 'Boolean') {\n              if (!value) {\n                this.removeAttribute(attrName);\n              } else {\n                this.setAttribute(attrName, attrName);\n              }\n            } else {\n              this.setAttribute(attrName, value);\n            }\n          }\n          this.invalidate();\n        },\n      });\n    }\n    return this;\n  }\n\n  render(): TemplateResult {\n    return html``;\n  }\n\n  attributeChangedCallback(prop: string, _oldValue: string, newValue: string) {\n    const { type: typeFn } = (this.constructor as any).properties[prop];\n\n    if (typeFn.name === 'Boolean') {\n      this._values[prop] = (newValue === '') || (newValue === prop);\n    } else {\n      this._values[prop] = typeFn(newValue);\n    }\n\n    this.invalidate();\n  }\n\n  connectedCallback() {\n    // FIXME: Should we force render here?\n    this.invalidate();\n  }\n\n  async invalidate() {\n    if (!this._needsRender) {\n      this._needsRender = true;\n      // Schedule the following as micro task, which runs before\n      // requestAnimationFrame. All additional invalidate() calls\n      // before will be ignored.\n      // https://jakearchibald.com/2015/tasks-microtasks-queues-and-schedules/\n      this._needsRender = await false;\n      render(this.render(), this.shadowRoot as any);\n    }\n  }\n\n  $(id: string) {\n    let value = this._lookupCache[id];\n    if (!value && this.shadowRoot) {\n      const element = this.shadowRoot.getElementById(id);\n      if (element) {\n        value = element;\n        this._lookupCache[id] = element;\n      }\n    }\n    return value;\n  }\n}"]}